services:
  liff:
    image: node:22
    working_dir: /app
    volumes:
      - ../../..:/app:cached
    environment:
      # Used by vite.config.ts to proxy /liff/* to mock-api inside docker
      - LIFF_PROXY_TARGET=http://mock-api:8787
    command: bash -lc "cd liff/examples/vite && npm ci && npm run dev -- --host 0.0.0.0 --port 5173"
    ports:
      - "5173:5173"
    depends_on:
      - mock-api

  mock-api:
    image: node:22
    working_dir: /app
    volumes:
      - ./mock-api:/app:cached
    command: bash -lc "npm ci && npm run dev"
    ports:
      - "8787:8787"
